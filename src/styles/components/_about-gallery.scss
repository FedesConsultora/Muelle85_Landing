@use '../_variables' as v;

.about__gallery { margin: 0; padding: 0; }

/* Full-bleed real */
.about__gallery--full{
  position: relative;
  width: 100vw;
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
}

.gallery{
  --accent: #{v.$color-secondary}; /* azul de marca */
  position: relative;
  width: 100vw;
  min-height: 100svh;
  height: 90dvh;
  overflow: hidden;
  background: transparent;
}

.gallery__viewport{ position: absolute; inset: 0; }

/* Cross-fade suave + Ken Burns sutil en la imagen activa (sin saltos) */
.gallery__slide{
  position: absolute; inset: 0;
  opacity: 0; visibility: hidden;
  transition: opacity .75s ease-in-out, visibility 0s linear .75s;
  will-change: opacity; pointer-events: none;
  width: 100%; margin: 0 !important;

  &.is-active{
    opacity: 1; visibility: visible; pointer-events: auto;
    transition: opacity .75s ease-in-out, visibility 0s linear 0s;
  }
}
.gallery__img{
  width: 100%; height: 100%; object-fit: cover; display: block;
  transform: translateZ(0); /* GPU */
}
.gallery__slide.is-active .gallery__img{
  animation: kb-zoom 4s ease-out forwards;
}
@keyframes kb-zoom{
  from{ transform: scale(1.01) translateZ(0); }
  to  { transform: scale(1.035) translateZ(0); }
}

/* Overlays para legibilidad */
.gallery__tintTop{
  position:absolute; inset:0 0 auto 0; height:45%;
  background: linear-gradient(180deg, rgba(0,0,0,.52), rgba(0,0,0,0));
  pointer-events:none;
}
.gallery__vignette{
  position:absolute; inset:0;
  background:
    radial-gradient(130% 100% at 50% 100%, rgba(0,0,0,.50), rgba(0,0,0,0) 55%),
    linear-gradient(0deg, rgba(0,0,0,.16), rgba(0,0,0,.16));
  pointer-events:none;
}

/* TÃ­tulo */
.gallery__title{
  position:absolute; top:clamp(20px, 8svh, 64px); left:50%;
  transform:translateX(-50%); width:min(1100px, 92vw); margin:0;
  text-align:center; color:#fff;
  font:800 clamp(1.4rem, 2.8vw, 2.4rem)/1.25 "Manrope", system-ui;
  text-shadow: 0 2px 14px rgba(0,0,0,.55);
}

/* Barra glass */
.gallery__glassbar{
  position:absolute; left:50%; bottom:18px; transform:translateX(-50%);
  width:min(1024px, 94vw);
  display:grid; grid-auto-flow:column; justify-content:space-between;
  gap:6px; padding:10px; border-radius:14px;
  background: rgba(0,0,0,.28);
  border:1px solid rgba(255,255,255,.12);
  backdrop-filter: blur(12px) saturate(1.15);
  box-shadow: inset 0 0 18px rgba(0,0,0,.25), 0 8px 22px rgba(0,0,0,.28);
  overflow:hidden;

  --pulse-origin: 50%; /* set por JS */
}

/* Pulso direccional en azul: nace desde el tab activo */
.gallery__glassbar::after{
  content:""; position:absolute; top:0; bottom:0;
  left: var(--pulse-origin);
  width: 160px; transform: translateX(-50%) scaleX(.1);
  opacity: 0; pointer-events:none;
  background: radial-gradient(60% 80% at 50% 50%,
    rgba(18,47,74,.55), rgba(18,47,74,0) 70%); /* azul */
  filter: blur(8px);
}
@keyframes pulse-right-slow{
  0%{ opacity:0; transform: translateX(-50%) scaleX(.2); }
  30%{ opacity:.9; }
  100%{ opacity:0; transform: translateX(-50%) scaleX(2.8); }
}
@keyframes pulse-left-slow{
  0%{ opacity:0; transform: translateX(-50%) scaleX(.2); }
  30%{ opacity:.9; }
  100%{ opacity:0; transform: translateX(-50%) scaleX(2.8); }
}
.gallery__glassbar.dir-next.pulse-a::after,
.gallery__glassbar.dir-next.pulse-b::after{ transform-origin: left center;  animation: pulse-right-slow 950ms ease; }
.gallery__glassbar.dir-prev.pulse-a::after,
.gallery__glassbar.dir-prev.pulse-b::after{ transform-origin: right center; animation: pulse-left-slow  950ms ease; }

/* Tabs: texto puro. Sin fondos ni subrayados. */
.gallery__tab{
  position:relative; appearance:none; border:0; background:transparent;
  color: rgba(233,238,245,.92); /* v.$color-text con leve opacidad */
  font:600 clamp(.78rem, 1.4vw, .95rem)/1.1 "Manrope", system-ui;
  letter-spacing:.2px; padding:12px 14px; border-radius:10px; cursor:pointer;
}

/* Glow sutil constante para el activo (no titila) */
.gallery__tab.is-active{
  color:#fff;
  /* glow azul limpio desde la fuente */
  text-shadow:
    0 0 8px rgba(18,47,74,.35),
    0 0 18px rgba(18,47,74,.20);
}

/* Glint SOLO en el cambio (se reinicia con pulse-a/b) */
.gallery__tab.is-active::after{
  content: attr(data-label);
  position:absolute; inset:0; display:grid; place-items:center;
  pointer-events:none;
  background:
    linear-gradient(110deg,
      rgba(18,47,74,0) 0%,
      rgba(18, 74, 36, 0.674) 45%,
      rgba(18, 74, 32, 0) 70%);
  background-size: 220% 100%;
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  opacity: 1;
}

@keyframes glint-right { from { background-position: -130% 0; } to { background-position: 130% 0; } }
@keyframes glint-left  { from { background-position:  130% 0; } to { background-position:-130% 0; } }

.dir-next.pulse-a .gallery__tab.is-active::after,
.dir-next.pulse-b .gallery__tab.is-active::after { animation: glint-right 1.05s ease; }
.dir-prev.pulse-a .gallery__tab.is-active::after,
.dir-prev.pulse-b .gallery__tab.is-active::after { animation: glint-left  1.05s ease; }

/* Mobile wrap */
@media (max-width: 720px){
  .gallery__glassbar{ grid-auto-flow:row; grid-template-columns: repeat(2, 1fr); gap:8px; }
}

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  .gallery__slide,
  .gallery__glassbar::after,
  .gallery__tab.is-active::after { animation:none !important; }
}
